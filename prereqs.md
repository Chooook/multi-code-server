- Необходимые зависимости устанавливаются единожды автоматическим скриптом
- Пользователям выделяются статические порты на основе их UID с учетом уже занятых (1 под nginx и 1 под code-server как минимум, разделить на пулы?)
- Конфигурации создаются автоматически для всех пользователей (кроме root) на основе шаблонов systemd system unit
- Проверка наличия новых пользователей запускается раз в 12 часов с использованием systemd timer (изучить)
- Сервисы запускаются на стороне пользователя, как systemd user units, чтобы пользователь (или его сервис) мог перезапускать сервисы
- Конфигурации сервисов хранятся в директории `/etc/systemd/user/` (права - ReadOnly)
- Если нужно больше свободы в редактировании конфигов - хранить в директории `~/.config/systemd/user/`
- Хранить сервисы, которые должны работать у всех и не требуют отдельной конфигурации тут: `/usr/lib/systemd/user/` (изучить)
- Конфигурация code-service хранится в пользовательской директории для возможности смены пароля
- Для всех пользователей автоматически включается лингеринг для работы сервисов при отсутствии пользовательской сессии
- У пользователей должна быть доступная инструкция по управлению сервисами с их описанием, а так же дополнительные скрипты управления (смена пароля)
- В конфигурациях user units должны учитываться проблемы с: переменными окружения, зависимостями, D-Bus, логированием
- Пользовательские code-service должны останавливаться при отсутствии веб-активности и выполняемых задач (как проверить?) в течение часа
- Нужен root скрипт для очистки всех конфигураций и отключения сервисов определенного пользователя по запросу
- Нужен root скрипт для получения статуса всех связанных сервисов всех пользователей (общий статус наличия, активность менеджера, nginx и code-server)
- У root и пользователей есть скрипт для просмотра логов работы сервисов (нужно ли пользователям, можно только root)
- Пользовательские code-server проксируются с помощью пользовательских конфигураций nginx (уточнить необходимость, изучить)
- Пользователи пробрасывают адрес code-service на личную машину по ssh
- Есть пользовательская инструкция по настройке и простому запуску ssh соединения (или ссылка на неё)
- Пользовательские сервисы должны запускаться при появлении веб-активности по адресу пользователя
